(this.webpackJsonpnoctis=this.webpackJsonpnoctis||[]).push([[0],{11:function(e,t,a){e.exports=a.p+"static/media/logo512.44b122e7.png"},22:function(e,t,a){e.exports=a(37)},27:function(e,t,a){},36:function(e,t,a){},37:function(e,t,a){"use strict";a.r(t);var o=a(0),n=a.n(o),l=a(19),r=a.n(l),c=a(4),i=(a(27),a(1)),s=a(2),m=Object(o.createContext)();function u(){return Object(o.useContext)(m)}var p=a(20);var d=function(e){var t=e.component,a=Object(p.a)(e,["component"]),o=u().authToken;return n.a.createElement(s.b,Object.assign({},a,{render:function(e){return o?n.a.createElement(t,e):n.a.createElement(s.a,{to:"/login"})}}))},f=(a(33),a(11)),g=a.n(f);var h=function(e){var t=Object(o.useState)(""),a=Object(i.a)(t,2),l=a[0],r=a[1],m=Object(o.useState)(""),p=Object(i.a)(m,2),d=p[0],f=p[1],h=Object(o.useState)(""),y=Object(i.a)(h,2),E=y[0],b=y[1],v=Object(o.useState)(""),N=Object(i.a)(v,2),O=N[0],S=N[1],k=Object(o.useState)(""),j=Object(i.a)(k,2),w=j[0],I=j[1],x=u().setAuthToken;function C(e){if(e.preventDefault(),document.getElementById("validation-error").style.display="none",function(){var e=0;return l.length<4&&(e=1),E.length<6&&(e=1),0===d.length&&(e=1),1===e?(document.getElementById("validation-error").style.display="block",!1):(document.getElementById("validation-error").style.display="none",!0)}()){document.getElementById("overlay").style.display="block";var t={username:l.toLowerCase(),name:d,email:E,password:O,confirmpassword:w,audience:"chocoboAPI"};fetch("https://chocobo.moogleapi.com/v1/account/register",{method:"post",headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json"},body:JSON.stringify(t)}).then((function(e){return e.json()})).then((function(e){document.getElementById("overlay").style.display="none",e.accessToken?(localStorage.setItem("user",JSON.stringify(e.user)),localStorage.setItem("refreshToken",JSON.stringify(e.refreshToken)),x(e.accessToken)):(console.log("registration failed"),console.log(e.errors),function(e){var t=e.Password,a=e.ConfirmPassword,o=e.Email,n="";void 0!==o&&(n=o),void 0!==t&&(n+="<br/>"+t),void 0!==a&&(n+="<br/>"+a),document.getElementById("validation-error").innerHTML=n,document.getElementById("validation-error").style.display="block"}(e.errors))}))}else console.log("validation failed")}return localStorage.accessToken?(e.history.push("/profile"),n.a.createElement(s.a,{to:"/profile"})):n.a.createElement("header",{className:"form-container register-screen"},n.a.createElement("img",{src:g.a,className:"main-photo",alt:"logo"}),n.a.createElement("p",null,"Sign up!"),n.a.createElement("form",null,n.a.createElement("div",{className:"form-group"},n.a.createElement("input",{type:"text",className:"form-control input-control",placeholder:"Enter username",onChange:function(e){r(e.target.value)}})),n.a.createElement("div",{className:"form-group"},n.a.createElement("input",{type:"text",className:"form-control input-control",placeholder:"Enter name",onChange:function(e){f(e.target.value)}})),n.a.createElement("div",{className:"form-group"},n.a.createElement("input",{type:"email",className:"form-control input-control",placeholder:"Enter email",onChange:function(e){b(e.target.value)}})),n.a.createElement("div",{className:"form-group"},n.a.createElement("input",{type:"password",className:"form-control input-control",placeholder:"Enter password",onChange:function(e){S(e.target.value)}})),n.a.createElement("div",{className:"form-group"},n.a.createElement("input",{type:"password",className:"form-control input-control",placeholder:"Confirm password",onChange:function(e){I(e.target.value)}})),n.a.createElement("div",{id:"validation-error"},"form validation failed"),n.a.createElement("button",{type:"submit",className:"btn btn-primary btn-block",onClick:function(e){return C(e)}},"Register")),n.a.createElement("p",{className:"font-regular mt-3"},"Or ",n.a.createElement(c.c,{to:"/login",className:"link"},"Login")))};var y=function(e){var t=Object(o.useState)(""),a=Object(i.a)(t,2),l=a[0],r=a[1],m=Object(o.useState)(""),p=Object(i.a)(m,2),d=p[0],f=p[1],h=u().setAuthToken;function y(e){if(e.preventDefault(),document.getElementById("login-error").style.display="none",document.getElementById("validation-error").style.display="none",l.length>0&&l.length>0||(document.getElementById("validation-error").style.display="block",0)){document.getElementById("overlay").style.display="block";var t={username:l,password:d,audience:"chocoboAPI"};fetch("https://chocobo.moogleapi.com/v1/account/login",{method:"post",headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json"},body:JSON.stringify(t)}).then((function(e){return e.json()})).then((function(e){e.accessToken?(localStorage.setItem("user",JSON.stringify(e.user)),localStorage.setItem("refreshToken",JSON.stringify(e.refreshToken)),h(e.accessToken)):(console.log("failed login"),console.log(e.message),document.getElementById("overlay").style.display="none",document.getElementById("login-error").style.display="block")}))}else console.log("validation failed")}return localStorage.accessToken?(e.history.push("/profile"),n.a.createElement(s.a,{to:"/profile"})):n.a.createElement("header",{className:"form-container login-screen"},n.a.createElement("img",{src:g.a,className:"main-photo",alt:"logo"}),n.a.createElement("p",null,"\xa0"),n.a.createElement("form",null,n.a.createElement("div",{className:"form-group"},n.a.createElement("input",{type:"text",className:"form-control input-control",placeholder:"Enter username",value:l,onChange:function(e){r(e.target.value)}})),n.a.createElement("div",{className:"form-group"},n.a.createElement("input",{type:"password",className:"form-control input-control",placeholder:"Enter password",value:d,onChange:function(e){f(e.target.value)}})),n.a.createElement("div",{id:"login-error"},"invalid credentials"),n.a.createElement("div",{id:"validation-error"},"enter your credentials"),n.a.createElement("button",{type:"submit",className:"btn btn-primary btn-block",onClick:function(e){return y(e)}},"Login")),n.a.createElement("p",{className:"font-regular mt-3"},"Or ",n.a.createElement(c.c,{to:"/register",className:"link"},"Register")))},E=a(9),b=a.n(E);function v(){document.getElementById("update-notification").style.display="none"}function N(){document.getElementById("overlay").style.display="none",console.log("user deleted")}function O(){document.getElementById("upload-photo").click()}function S(){document.getElementById("upload-wallpaper").click()}function k(e){var t=e.photos.filter((function(e){return 1===e.portrait}));return t.length>0?t[0].url:""}function j(e){var t=e.photos.filter((function(e){return 1===e.wallpaper}));return t.length>0?t[0].url:""}var w=function(e){var t,a=Object(o.useState)(""),l=Object(i.a)(a,2),r=l[0],s=(l[1],Object(o.useState)("")),m=Object(i.a)(s,2),u=m[0],p=m[1],d=Object(o.useState)(""),f=Object(i.a)(d,2),g=f[0],h=f[1],y=Object(o.useState)(""),E=Object(i.a)(y,2),w=E[0],I=E[1],x=Object(o.useState)(""),C=Object(i.a)(x,2),B=C[0],T=C[1],J=Object(o.useState)(""),D=Object(i.a)(J,2),A=D[0],L=D[1],Y=Object(o.useState)(""),M=Object(i.a)(Y,2),U=M[0],P=M[1],R=Object(o.useState)(""),V=Object(i.a)(R,2),z=V[0],W=V[1],F=Object(o.useState)(""),H=Object(i.a)(F,2),$=H[0],q=H[1];if(!localStorage.user||!localStorage.accessToken)return e.history.push("/login"),n.a.createElement(c.a,{to:"/login"});!function(){var e=JSON.parse(localStorage.user);fetch("https://chocobo.moogleapi.com/v1/manage/get/"+e.userName,{method:"get"}).then((function(e){return e.json()})).then((function(e){localStorage.setItem("user",JSON.stringify(e))}))}();var G=k(t=JSON.parse(localStorage.user)),K=j(t);function Q(e){!function(e){var t=JSON.parse(localStorage.refreshToken);fetch("https://chocobo.moogleapi.com/v1/account/refresh",{method:"post",headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json",Authorization:"Bearer "+e},body:JSON.stringify(t)}).then((function(e){return e.json()})).then((function(e){localStorage.setItem("accessToken",JSON.stringify(e.accessToken)),localStorage.setItem("refreshToken",JSON.stringify(e.refreshToken))}))}(JSON.parse(localStorage.accessToken)),e.preventDefault(),document.getElementById("overlay").style.display="block";var t=JSON.parse(localStorage.user);document.getElementById("validation-error").style.display="none";var a=new FormData;a.append("id",t.id),a.append("portrait",""===z?t.photo:document.forms["profile-form"]["upload-photo"].files[0]),a.append("wallpaper",""===$?t.wallpaper:document.forms["profile-form"]["upload-wallpaper"].files[0]),a.append("username",""===r?t.userName:r),a.append("email",""===g?t.email:g),a.append("name",""===u?t.name:u),a.append("bio",""===w?t.bio:w),a.append("birthdate",""===B?t.birthDate:B),a.append("city",""===A?t.city:A),a.append("state",""===U?t.state:U),fetch("https://chocobo.moogleapi.com/v1/manage/update",{method:"put",headers:{Authorization:"Bearer "+JSON.parse(localStorage.accessToken)},body:a}).then((function(e){return 200===e.status?e.json().then((function(t){document.getElementById("overlay").style.display="none",t.user?(localStorage.setItem("user",JSON.stringify(t.user)),document.getElementById("update-notification").style.display="block"):(console.log("update failed"),console.log(e.errors))})):(console.log("Probably an invalid token. Log in again."),localStorage.clear(),n.a.createElement(c.a,{to:"/"}))}))}return document.getElementById("overlay").style.display="none",n.a.createElement("div",{className:"form-container form-container-profile component"},n.a.createElement("div",{id:"profile-container",className:"profile-container"},n.a.createElement("div",{id:"wallpaper-photo",className:"wallpaper-photo",style:K?{backgroundImage:"url("+K+")"}:{},onClick:S},n.a.createElement("span",null,n.a.createElement("i",{className:"fas fa-camera"})),n.a.createElement("div",{id:"profile-photo",className:"profile-photo",style:G?{backgroundImage:"url("+G+")"}:{},onClick:O},n.a.createElement("span",null,n.a.createElement("i",{className:"fas fa-camera"})))),n.a.createElement("p",{id:"username",className:"font-weight-bold"},t.userName)),n.a.createElement("form",{name:"profile-form",id:"profile-form",className:"profile-form",encType:"multipart/form-data",method:"put"},n.a.createElement("p",{className:"font-small text-secondary"},"Joined ",b()(t.joinDate).format("MMMM DD, YYYY")),n.a.createElement("div",{id:"update-notification",className:"alert alert-success alert-dismissible text-center fade show small",role:"alert",style:{display:"none"}},n.a.createElement("span",{style:{fontSize:"16px"}},"User information updated!"),n.a.createElement("button",{type:"button",className:"close","data-dismiss":"alert","aria-label":"Close",onClick:v},n.a.createElement("span",{"aria-hidden":"true"},"\xd7"))),n.a.createElement("div",{className:"input-group mb-2 row"},n.a.createElement("label",{className:"col-3 col-form-label px14 text-left font-weight-bold "},"Email"),n.a.createElement("input",{type:"text",className:"form-control col-9",defaultValue:t.email,placeholder:"Enter email",onChange:function(e){h(e.target.value)}}),n.a.createElement("i",{className:"fas fa-pencil-alt"})),n.a.createElement("div",{className:"input-group mb-2 row"},n.a.createElement("label",{className:"col-3 col-form-label px14 text-left font-weight-bold "},"Name"),n.a.createElement("input",{type:"text",className:"form-control col-9",defaultValue:t.name,placeholder:"Enter name",onChange:function(e){p(e.target.value)}})),n.a.createElement("div",{className:"input-group mb-2 row"},n.a.createElement("label",{className:"col-3 col-form-label px14 text-left font-weight-bold "},"Birthday"),n.a.createElement("input",{type:"date",className:"form-control col-9",defaultValue:b()(t.birthDate).format("YYYY-MM-DD"),onChange:function(e){T(e.target.value)}})),n.a.createElement("div",{className:"input-group mb-2 row"},n.a.createElement("label",{className:"col-3 col-form-label px14 text-left font-weight-bold "},"City"),n.a.createElement("input",{type:"text",className:"form-control col-9",defaultValue:t.city,placeholder:"Enter city",onChange:function(e){L(e.target.value)}})),n.a.createElement("div",{className:"input-group mb-2 row"},n.a.createElement("label",{className:"col-3 col-form-label px14 text-left font-weight-bold "},"State"),n.a.createElement("input",{type:"text",className:"form-control col-9",defaultValue:t.state,placeholder:"Enter state",onChange:function(e){P(e.target.value)}})),n.a.createElement("div",{className:"input-group mb-2 row"},n.a.createElement("label",{className:"col-3 col-form-label px14 text-left font-weight-bold "},"Bio"),n.a.createElement("textarea",{type:"text",className:"form-control",defaultValue:t.bio,placeholder:"Enter a brief description of yourself",onChange:function(e){I(e.target.value)}})),n.a.createElement("div",{className:"row mx-0 photo-grid"},t.photos.map((function(e){return n.a.createElement("div",{key:e.id},n.a.createElement("img",{className:"photo",src:e.url,alt:e.name}))}))),n.a.createElement("div",{id:"validation-error"},"form validation failed"),n.a.createElement("input",{id:"upload-photo",type:"file",accept:"image/*",name:"photo",onChange:function(e){!function(e){var t=URL.createObjectURL(e.target.files[0]);t&&(document.getElementById("profile-photo").style.backgroundImage="url("+t+")",W(e.target.value))}(e)}}),n.a.createElement("input",{id:"upload-wallpaper",type:"file",accept:"image/*",name:"wallpaper",onChange:function(e){!function(e){var t=URL.createObjectURL(e.target.files[0]);t&&(document.getElementById("wallpaper-photo").style.backgroundImage="url("+t+")",q(e.target.value))}(e)}}),n.a.createElement("div",{className:"button-container text-muted"},n.a.createElement("p",{title:"Logout",onClick:function(){return localStorage.clear(),e.history.push("/"),n.a.createElement(c.a,{to:"/"})}},"Logout"),n.a.createElement("p",{title:"Update Information",onClick:function(e){Q(e)}},"Update Info"),n.a.createElement("p",{title:"Delete Account",className:"text-danger",onClick:N},"Delete Account"))))};a(12);a(36);var I=function(e){var t=JSON.parse(localStorage.getItem("accessToken")),a=Object(o.useState)(t),l=Object(i.a)(a,2),r=l[0],u=l[1];return n.a.createElement(m.Provider,{value:{authToken:r,setAuthToken:function(e){localStorage.setItem("accessToken",JSON.stringify(e)),u(e)}}},n.a.createElement(c.b,{basename:""},n.a.createElement(s.b,{exact:!0,path:"/",component:y}),n.a.createElement(s.b,{exact:!0,path:"/login",component:y}),n.a.createElement(s.b,{exact:!0,path:"/register",component:h}),n.a.createElement(d,{exact:!0,path:"/profile",component:w})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(n.a.createElement(c.a,null,n.a.createElement(I,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[22,1,2]]]);
//# sourceMappingURL=main.9fcabe38.chunk.js.map